<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Theme Made By www.w3schools.com - No Copyright -->
  <title>Log Review</title>
  {% load staticfiles %}

        <link rel="stylesheet" href="{% static 'index/drone.css' %}">
      <script src="{% static 'index/jquery.min.js' %}"></script>
      <link rel="stylesheet" type="text/css" href="{% static 'index/jquery-ui.min.css' %}" />
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="{% static 'index/bootstrap.css' %}">
      <link rel="stylesheet" href="{% static 'index/bootstrap-theme.css' %}">
      <script src="{% static 'index/bootstrap.min.js' %}"></script>
      <link rel="stylesheet" type="text/css" href="{% static 'index/DataTables/datatables.min.css' %}"/>

      <script type="text/javascript" src="{% static 'index/DataTables/datatables.min.js' %}"></script>


    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">-->

    <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
	<!--<link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond|Cuprum|Days+One|Montserrat|Numans|Philosopher|Roboto+Mono|Roboto+Slab|Yeseva+One" rel="stylesheet">-->
</head>
<body class="mainBodyFlight">

<nav>
      <ul>
        <li><a class="menulogo" href="{% url 'index:index' %}"> </a></li>
        <li><a class="menuHome" href="{% url 'index:index' %}"><span class= "titleNav">Home</span></a></li>
        <li><a class="menuFlights" href="{% url 'flight_monitor:flight_monitor' %}"><span class= "titleNavF">Flights</span> </a></li>
        <li><a class="menuReviews" href="{% url 'reviews:reviews' %}"><span class= "titleNav">Reviews</span></a></li>
        <li><a class="menuSetup" href="{% url 'drone_setup:drone_setup' %}"><span class= "titleNav">Setup</span></a></li>
        <li><a class="menuMange" href="{% url 'management:management' %}"><span class= "titleNav">Management</span></a></li>
      </ul>
  </nav>

`<h1 id= "title_review_page">All Flights</h1>
  <div id="tblReviews">
    <table id = "drone_review" class="table table-striped table-condensed table-bordered table-hover" width="95%">

      <thead>
      <tr  >
           <th id="thReview_id">
          <select id= "drone_id" name="drone_id" class="input-field" style="text-align-last:center;" >
              <option value=''>Drone ID</option>
              {% for value in drone_ids %}
                <option value= "{{ value }}">{{ value }}</option>
              {% endfor %}
            <!--{% csrf_token %}-->
          </select>
        </th>
        <th id="thReview_startTime" >
          <div style="margin-right: 3px;">
            <div style="padding-right: 3px;">
                <input id="start_time" class="textbox-n" type="text" onfocus="this.type = 'date'" onblur="this.type = 'text'" placeholder="Flight Start Date" onchange="sort_results('start_flight_time',this.value)" style="width:100%; text-align-last:center;">
            </div>
          </div>
        </th>
        <th id="thReview_endTime" >
          <div style="margin-right: 3px;">
            <div style="padding-right: 3px;">
                <input id="end_time" class="textbox-n" type="text" onfocus="this.type = 'date'" onblur="this.type = 'text'" placeholder="Flight End Date" onchange="sort_results('end_flight_time',this.value)" style="width:100%; text-align-last:center;">
            </div>
          </div>
        </th>
        <th id="thReview_duration" >
          <div style="margin-right: 3px;">
            <div style="padding-right: 3px;">
                <input id="duration" class="textbox-n" type="text" placeholder="Duration" onchange="sort_results('duration',this.value)" style="width:100%; text-align-last:center;">
            </div>
          </div>
        </th>
        <th id="thReview_log" >Flight Log</th>
        <th id="thReview_status" >
            <select id= "drone_states" name="drone_states" class="input-field" style="text-align-last:center;" >
              <option value=''>Status</option>
              {% for value in drone_states %}
                <option value= "{{ value }}">{{ value }}</option>
              {% endfor %}
            <!--{% csrf_token %}-->
          </select>
        </th>

        <th id="thReview_report" >Drone Report</th>
      </tr>
      </thead>
    </table>
  </div>
  <!-- logs Modal -->
  <div class="modal fade" id="modalLogsPopUp" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" id="modalTitle"></h4>
        </div>
        <div class="modal-body" id="modalBody">
          <p> </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</body>
<script type="text/javascript">
        var mydata =
        [
            {% for key, value in result.items %}
                {
                    {% for key2, value2 in value.items %}
                        '{{ key2 }}' : '{{ value2 }}' ,
                    {% endfor %}
                },
            {% endfor %}
        ]
        var table = $('#drone_review').DataTable( {
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                data : mydata,
                columns: [
                            { data: 'drone_num' },
                            { data: 'start_flight_time' },
                            { data: 'end_flight_time' },
                            { data: 'duration' },
                            { "defaultContent": "<button id='log'  class='log_btn'  role='button'></button>" },
                            { data: 'state' },
                            { "defaultContent": "<button id='report' class='report_btn' role='button'></button>" },
                            {
                                data: 'log_file_path',
                                visible: false
                            }
                        ]
            } );
        $('#drone_review tbody').on( 'click', 'button', function () {
            jQuery.noConflict();
            if (this.id == "report")
            {
                var data = table.row( $(this).parents('tr') ).data();
                showReportPopUpForReview(data.drone_num);
                $("#modalLogsPopUp").modal('show');
            }
            else
            {
                var data = table.row( $(this).parents('tr') ).data();
                showPopUpForReview(data.log_file_path);
                $("#modalLogsPopUp").modal('show');
            }
        } );
    </script>
    <script src="{% static 'index/reviews.js' %}"></script>
</html>
